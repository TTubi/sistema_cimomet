{% extends 'base.html' %}

{% block title %}Detalle de Tarea{% endblock %}

{% block content %}
  <div class="container mt-4">
    <h2>{{ tarea.titulo }}</h2>
    <p><strong>Descripción:</strong> {{ tarea.descripcion }}</p>
    <p><strong>Estado actual:</strong> {{ tarea.get_estado_display }}</p>
    <p><strong>Asignada a:</strong> {{ tarea.asignado_a }}</p>
    <p><strong>Creada por:</strong> {{ tarea.creada_por }}</p>
    <p><strong>Fecha de creación:</strong> {{ tarea.fecha_creacion|date:"d/m/Y H:i" }}</p>
{% if tarea.plano %}
  <div class="mt-3">
    <p><strong>Plano adjunto:</strong></p>
    <img src="{{ tarea.plano.url }}" alt="Plano de la tarea" style="max-width: 600px;">
  </div>
{% else %}
  <p><em>No hay plano adjunto.</em></p>
{% endif %}
    <hr>

    {% if es_operario and tarea.estado == 'pendiente' %}
      <form method="post">
        {% csrf_token %}
        <button type="submit" name="accion" value="enviar_control" class="btn btn-success">
          Enviar a control
        </button>
      </form>

    {% elif es_controlador and tarea.estado == 'en_revision' %}
      <form method="post">
        {% csrf_token %}
        <button type="submit" name="accion" value="aceptar" class="btn btn-primary me-2">
          Finalizada
        </button>
        <button type="submit" name="accion" value="rechazar" class="btn btn-warning me-2">
          Reenviar a operario
    {% endif %}
  </div>
{% endblock %}